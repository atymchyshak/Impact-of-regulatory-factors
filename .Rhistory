# Data analysis
library(readr)
Data <- read_csv("Data.csv", col_types = cols(...1 = col_skip()))
Temperature <- read_csv("Temperature.csv")
Cost <- read_csv("Cost.csv")
res<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
res_lm<-lm(consumption~temperature+cost, data = df)
summ_lm<-summary(res_lm)
res<-c(res, summ_lm[["coefficients"]]["cost", "Pr(>|t|)"])
}
names(res)<-Data$N
Data_res<-cbind(Data, res)
tbl_res<-table(Data_res$cat, Data_res$res<0.05)
perc<-function(tab)
{
res<-tab
if(is.null(dim(res)))
{k<-1
res<-round(res/sum(res)*100,digits = 2)
}
else
{k<-nrow(res)
for(i in 1:k)
res[i,]<-round(res[i,]/sum(res[i,])*100,digits = 2)
}
return(res)
}
tbl_res_perc(tbl_res)
perc(tbl_res)
perc(apply(tbl_res,2,sum))
res1<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
res_cor<-cor.test(~consumption+cost, data = df, method = "spearman")
res1<-c(res1, res_cor$p.value)
}
names(res1)<-Data$N
Data_res<-cbind(Data, res, res1)
tbl_res1<-table(Data_res$cat, Data_res$res1<0.05)
perc(tbl_res1)
perc(apply(tbl_res1,2,sum))
View(Data_res)
View(df)
plot(df$cost,df$consumption)
plot(df$temperature,df$consumption)
rgl:plot3d(res_lm)
rgl::plot3d(res_lm)
library(rgl)
options(rgl.printRglwidget = TRUE)
open3d()
plot3d(res_lm)
# Data analysis
library(readr)
function (x, df1, df2, ncp, log = FALSE)
{
if (missing(ncp))
.Call(C_df, x, df1, df2, log)
else .Call(C_dnf, x, df1, df2, ncp, log)
}
Data <- read_csv("Data.csv", col_types = cols(...1 = col_skip()))
Temperature <- read_csv("Temperature.csv")
Cost <- read_csv("Cost.csv")
res<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
res_lm<-lm(consumption~temperature+cost, data = df)
summ_lm<-summary(res_lm)
res<-c(res, summ_lm[["coefficients"]]["cost", "Pr(>|t|)"])
}
names(res)<-Data$N
res1<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
res_cor<-cor.test(~consumption+cost, data = df, method = "spearman")
res1<-c(res1, res_cor$p.value)
}
names(res1)<-Data$N
warnings()
Data_res<-cbind(Data, lm=res, cor=res1)
tbl_lm<-table(Data_res$cat, Data_res$lm<0.05)
tbl_cor<-table(Data_res$cat, Data_res$cor<0.05)
perc<-function(tab)
{
res<-tab
if(is.null(dim(res)))
{k<-1
res<-round(res/sum(res)*100,digits = 2)
}
else
{k<-nrow(res)
for(i in 1:k)
res[i,]<-round(res[i,]/sum(res[i,])*100,digits = 2)
}
return(res)
}
perc(tbl_lm)
perc(apply(tbl_lm,2,sum))
perc(tbl_cor)
perc(apply(tbl_cor,2,sum))
res1<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
res_cor<-cor.test(~consumption+cost, data = df, method = "pearson")
res1<-c(res1, res_cor$p.value)
}
names(res1)<-Data$N
Data_res<-cbind(Data, lm=res, cor=res1)
tbl_cor<-table(Data_res$cat, Data_res$cor<0.05)
perc(tbl_cor)
perc(apply(tbl_cor,2,sum))
install.packages("plm")
install.packages("lmtest")
library(lmtest)
data(ChickEgg)
grangertest(egg ~ chicken, order = 3, data = ChickEgg)
grangertest(chicken ~ egg, order = 3, data = ChickEgg)
ChickEgg
library(plm)
data("Grunfeld", package = "plm")
pgrangertest(inv ~ value, data = Grunfeld)
pgrangertest(inv ~ value, data = Grunfeld, order = 2L)
pgrangertest(inv ~ value, data = Grunfeld, order = 2L, test = "Zbar")
Grunfeld
Gasoline
data("Gasoline", package = "plm")
Gasoline
Gas <- pdata.frame(Gasoline, index = c("country", "year"), drop.index = TRUE)
View(Gas)
View(Data)
dat<-data.frame(ID=rep(Data$N[1],43), time=names(Data)[4:46],cons=t(Data[1,4:46]),temp=Temperature[1], cost=Cost[1])
View(dat)
dat<-data.frame(ID=rep(Data$N[1],43), time=names(Data)[4:46],cons=t(Data[1,4:46]),
temp=Temperature[1,], cost=Cost[1,])
dat<-data.frame(ID=rep(Data$N[1],43), time=names(Data)[4:46],cons=t(Data[1,4:46]),
temp=t(Temperature[1,]), cost=t(Cost[1,]))
View(dat)
for(i in 2:22774)
dat<-rbind(dat, data.frame(ID=rep(Data$N[1],43), time=names(Data)[4:46],cons=t(Data[i,4:46]),
temp=t(Temperature[1,]), cost=t(Cost[1,])))
dat<-data.frame(ID=rep(Data$N[1],43), time=names(Data)[4:46],cons=t(Data[1,4:46]),
temp=t(Temperature[1,]), cost=t(Cost[1,]))
for(i in 2:227)
dat<-rbind(dat, data.frame(ID=rep(Data$N[1],43), time=names(Data)[4:46],cons=t(Data[i,4:46]),
temp=t(Temperature[1,]), cost=t(Cost[1,])))
pdat<-pdata.frame(dat, index = c("ID", "time"))
View(pdat)
dat<-data.frame(ID=rep(Data$N[1],43), time=names(Data)[4:46],cons=t(Data[1,4:46]),
temp=t(Temperature[1,]), cost=t(Cost[1,]))
for(i in 2:227)
dat<-rbind(dat, data.frame(ID=rep(Data$N[i],43), time=names(Data)[4:46],cons=t(Data[i,4:46]),
temp=t(Temperature[1,]), cost=t(Cost[1,])))
pdat<-pdata.frame(dat, index = c("ID", "time"))
pgrangertest(cons~cost, data=pdat)
pdat$ID
dat<-data.frame(ID=rep(Data$N[1],43), time=names(Data)[4:46],cons=t(Data[1,4:46]),
temp=t(Temperature[1,]), cost=t(Cost[1,]))
for(i in 2:10)
dat<-rbind(dat, data.frame(ID=rep(Data$N[i],43), time=names(Data)[4:46],cons=t(Data[i,4:46]),
temp=t(Temperature[1,]), cost=t(Cost[1,])))
pdat<-pdata.frame(dat, index = c("ID", "time"))
pgrangertest(cons~cost, data=pdat)
dat<-data.frame(ID=rep(Data$N[1],43), year=c(rep(2019,7),
rep(2020,12),
rep(2021,12),
rep(2022,12))
month=c(7:12,1:12,1:12,1:12),
dat<-data.frame(ID=rep(Data$N[1],43), year=c(rep(2019,7),
rep(2020,12),
rep(2021,12),
rep(2022,12)),
month=c(7:12,1:12,1:12,1:12),
cons=t(Data[1,4:46]),
temp=t(Temperature[1,]),
cost=t(Cost[1,]))
dat<-data.frame(ID=rep(Data$N[1],43), year=c(rep(2019,7),
rep(2020,12),
rep(2021,12),
rep(2022,12)),
month=c(6:12,1:12,1:12,1:12),
cons=t(Data[1,4:46]),
temp=t(Temperature[1,]),
cost=t(Cost[1,]))
for(i in 2:10)
dat<-rbind(dat, data.frame(ID=rep(Data$N[i],43), year=c(rep(2019,7),
rep(2020,12),
rep(2021,12),
rep(2022,12)),
month=c(6:12,1:12,1:12,1:12),cons=t(Data[i,4:46]),
temp=t(Temperature[1,]), cost=t(Cost[1,])))
pdat<-pdata.frame(dat, index = c("ID", "year", "month"))
pgrangertest(cons~cost, data=pdat)
pgrangertest(cons~cost, data=pdat, index = c("ID", "year", "month"))
pgrangertest(cons~temp, data=pdat)
grangertest(cons~cost, data=dat)
grangertest(cons~cost, data=dat, order = 3)
grangertest(cost~cons, data=dat, order = 3)
# Data analysis
library(readr)
Data <- read_csv("Data.csv", col_types = cols(...1 = col_skip()))
Temperature <- read_csv("Temperature.csv")
Cost <- read_csv("Cost.csv")
dat<-data.frame(ID=rep(Data$N[1],43), year=c(rep(2019,7),
rep(2020,12),
rep(2021,12),
rep(2022,12)),
month=c(6:12,1:12,1:12,1:12),
cons=t(Data[1,4:46]),
temp=t(Temperature[1,]),
cost=t(Cost[1,]))
pdat<-pdata.frame(dat, index = c("ID", "year", "month"))
library("lmtest")
grangertest(cost~cons, data=dat, order = 3)
grangertest(cost~cons, data=dat, order = 1)
res_grander<-grangertest(cost~cons, data=dat, order = 1)
View(res_grander)
library(plm)
pdat<-pdata.frame(dat, index = c("ID", "year", "month"))
pgrangertest(cons~cost, data=pdat)
(res_grander<-grangertest(cons~cost, data=dat, order = 1))
# Data analysis
perc<-function(tab)
{
res<-tab
if(is.null(dim(res)))
{k<-1
res<-round(res/sum(res)*100,digits = 2)
}
else
{k<-nrow(res)
for(i in 1:k)
res[i,]<-round(res[i,]/sum(res[i,])*100,digits = 2)
}
return(res)
}
Data <- read_csv("Data.csv", col_types = cols(...1 = col_skip()))
Temperature <- read_csv("Temperature.csv")
Cost <- read_csv("Cost.csv")
# Data analysis
perc<-function(tab)
{
res<-tab
if(is.null(dim(res)))
{k<-1
res<-round(res/sum(res)*100,digits = 2)
}
else
{k<-nrow(res)
for(i in 1:k)
res[i,]<-round(res[i,]/sum(res[i,])*100,digits = 2)
}
return(res)
}
library(readr)
# Data analysis
perc<-function(tab)
{
res<-tab
if(is.null(dim(res)))
{k<-1
res<-round(res/sum(res)*100,digits = 2)
}
else
{k<-nrow(res)
for(i in 1:k)
res[i,]<-round(res[i,]/sum(res[i,])*100,digits = 2)
}
return(res)
}
library(readr)
Data <- read_csv("Data.csv", col_types = cols(...1 = col_skip()))
Temperature <- read_csv("Temperature.csv")
Cost <- read_csv("Cost.csv")
res<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
res_lm<-lm(consumption~temperature+cost, data = df)
summ_lm<-summary(res_lm)
res<-c(res, summ_lm[["coefficients"]]["cost", "Pr(>|t|)"])
}
names(res)<-Data$N
res1<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
res_cor<-cor.test(~consumption+cost, data = df, method = "pearson")
res1<-c(res1, res_cor$p.value)
}
names(res1)<-Data$N
library("lmtest")
res2<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
res_gr<-grangertest(cons~cost, data=dat, order = 1)
res2<-c(res2, res_gr[2,4])
}
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
res_gr<-grangertest(consumption~cost, data=df, order = 1)
res2<-c(res2, res_gr[2,4])
}
df
res_gr<-grangertest(consumption~cost, data=df, order = 1)
res_gr<-try(grangertest(consumption~cost, data=df, order = 1))
res_gr
res_gr<-grangertest(consumption~cost, data=df, order = 2)
res2<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
if(i==2033)res_gr<-NA
else
res_gr<-grangertest(consumption~cost, data=df, order = 2)
res2<-c(res2, res_gr[2,4])
}
res2<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
if(i==2033)
{
res_gr<-NA
res2<-c(res2,res_gr)
}
else
{res_gr<-grangertest(consumption~cost, data=df, order = 2)
res2<-c(res2, res_gr[2,4])
}
}
df
res2<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
if(is.element(i,c(2033, 4202)))
{
res_gr<-NA
res2<-c(res2,res_gr)
}
else
{res_gr<-grangertest(consumption~cost, data=df, order = 2)
res2<-c(res2, res_gr[2,4])
}
}
res2<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
if(var(df$consumption)==0)
{
res_gr<-NA
res2<-c(res2,res_gr)
}
else
{res_gr<-grangertest(consumption~cost, data=df, order = 2)
res2<-c(res2, res_gr[2,4])
}
}
var(df$consumption)
res2<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
if(is.element(i,c(2033, 4202))|var(df$consumption)==0)
{
res_gr<-NA
res2<-c(res2,res_gr)
}
else
{res_gr<-grangertest(consumption~cost, data=df, order = 2)
res2<-c(res2, res_gr[2,4])
}
}
df
res2<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
if(is.element(i,c(2033, 4202,6823))|var(df$consumption)==0)
{
res_gr<-NA
res2<-c(res2,res_gr)
}
else
{res_gr<-grangertest(consumption~cost, data=df, order = 2)
res2<-c(res2, res_gr[2,4])
}
}
df
res2<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
if(is.element(i,c(2033, 4202,6823,17542))|var(df$consumption)==0)
{
res_gr<-NA
res2<-c(res2,res_gr)
}
else
{res_gr<-grangertest(consumption~cost, data=df, order = 2)
res2<-c(res2, res_gr[2,4])
}
}
df
res2<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
if(is.element(i,c(2033, 4202,6823,17542,18564))|var(df$consumption)==0)
{
res_gr<-NA
res2<-c(res2,res_gr)
}
else
{res_gr<-grangertest(consumption~cost, data=df, order = 2)
res2<-c(res2, res_gr[2,4])
}
}
df
res2<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
if(is.element(i,c(2033, 4202,6823,17542,18564,19559))|var(df$consumption)==0)
{
res_gr<-NA
res2<-c(res2,res_gr)
}
else
{res_gr<-grangertest(consumption~cost, data=df, order = 2)
res2<-c(res2, res_gr[2,4])
}
}
res2<-NULL
for(i in 1:nrow(Data))
{
df<-data.frame(consumption = t(Data[i, 4:46]), temperature = t(Temperature), cost = t(Cost),
check.names = F, row.names = names(Cost))
if(is.element(i,c(2033, 4202,6823,17542,18564,19559,20903))|var(df$consumption)==0)
{
res_gr<-NA
res2<-c(res2,res_gr)
}
else
{res_gr<-grangertest(consumption~cost, data=df, order = 2)
res2<-c(res2, res_gr[2,4])
}
}
names(res2)<-Data$N
Data_res<-cbind(Data, lm=res, cor=res1, gr=res2)
write.csv(Data_res,"Res,csv")
View(Data_res)
tbl_lm<-table(Data_res$cat, Data_res$lm<0.05)
tbl_cor<-table(Data_res$cat, Data_res$cor<0.05)
tbl_gr<-table(Data_res$cat, Data_res$gr<0.05)
perc(tbl_lm)
perc(apply(tbl_lm,2,sum))
perc(tbl_cor)
perc(apply(tbl_cor,2,sum))
tbl_gr
perc(tbl_gr)
perc(apply(tbl_gr,2,sum))
#Results
Data_res<-read.csv("Res.csv")
